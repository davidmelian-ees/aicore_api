================================================================================
                     COMMON ERRORS IN SAP SPECIFICATIONS
                        Pre-Report Validation System
================================================================================

OBJECTIVE:
Automatically detect frequent errors BEFORE generating the complete
structural validation report. These errors are reported directly by the
specification generator and require priority automatic validation.

================================================================================
                              IDENTIFIED ERRORS
================================================================================

1. NUMBER OF LOTS:
‚ùå PROBLEM: Inconsistency between the number of lots declared and those actually included
   
   VALIDATIONS:
   - Count mentions of lot in the document
   - Verify sequential numbering (lot 1, lot 2, etc.)
   - Detect duplicate lots or gaps in numbering
   - Validate that each lot has an assigned budget
   
   PATTERNS TO DETECT:
   - ‚ÄúLOT \d+‚Äù (Lot 1, Lot 2, etc.)
   - ‚ÄúLot \d+‚Äù (Catalan variant)
   - Tables with lot columns
   - Budgets per lot

2. UNFILLED SAP TAGS:
   ‚ùå PROBLEM: SAP variable tags that were not replaced with actual data.
   
   VALIDATIONS:
   - Search for {{VARIABLE}} patterns.
   - Detect [PENDING_FIELD].
   - Find <<MISSING_DATA>>.
   - Identify {EMPTY_VALUE}
   - Locate @SAP_VARIABLE@
   
   CRITICAL PATTERNS:
   - {{.*?}} (any content between double curly brackets)
   - \[.*?\] (content between square brackets)
   - <<.*?>> (content between double less-than/greater-than signs)
   - @.*?@ (content between at signs)
   - {.*?} (content between single curly brackets)

3. DUPLICATED YES/NO FIELDS:
   ‚ùå PROBLEM: Checking both YES and NO in mutually exclusive fields.
   
   VALIDATIONS:
   - Detect ‚Äú‚òë YES‚Äù and ‚Äú‚òë NO‚Äù in the same section.
   - Search for simultaneous ‚ÄúX YES‚Äù and ‚ÄúX NO.‚Äù
   - Identify ‚Äú[X] YES‚Äù and ‚Äú[X] NO‚Äù checked
   - Validate duplicate checkboxes in forms
   
   PATTERNS TO DETECT:
   - (\[X\]|\‚òë|X)\s*(YES|IF).*?(\[X\]|\‚òë|X)\s* (NO)
   - Fields with both options checked
   - Sections with contradictory answers

4. INCORRECT DATE FORMAT:
   ‚ùå PROBLEM: Dates in incorrect or inconsistent format
   
   CORRECT CATALAN FORMAT: DD/MM/YYYY
   
   VALIDATIONS:
   - Detect dates in American format (MM/DD/YYYY)
   - Identify dates with hyphens (DD-MM-YYYY)
   - Validate dates in ISO format (YYYY-MM-DD)
   
   INCORRECT PATTERNS:
   - \d{4}-\d{2}-\d{2} (ISO format)
   - \d{1,2}-\d{1,2}-\d{4} (with hyphens)
   - [A-Za-z]+ \d{1,2}, \d{4} (English format)
   - Dates with months in English

5. INCORRECT AMOUNT FORMAT:
   ‚ùå PROBLEM: Amounts without the correct euro format or with incorrect separators.
   
   CORRECT FORMAT: 123.456,78 ‚Ç¨ (thousand separator, decimal point)
   
   VALIDATIONS:
   - Detect American format: 123.456,78 (period for thousands, comma for decimals)
   - Identify ‚Ç¨ at the end instead of the beginning
   - Validate incorrect separators
   - Check spaces between number and symbol
   
   INCORRECT PATTERNS:
   - ‚Ç¨\s*\d+ (euro at the end)
   - \d+‚Ç¨ (no space after the euro)

6. INCORRECT LANGUAGE (NOT CATALAN):
   ‚ùå PROBLEM: Text in Spanish or other languages instead of Catalan
   
   VALIDATIONS:
   - Detect common Spanish words
   - Identify untranslated technical terms
   - Validate names of months and weekdays in Catalan
   
   COMMON SPANISH WORDS TO DETECT:
   - ‚Äúpresupuesto‚Äù ‚Üí should be ‚Äòpressupost‚Äô
   - ‚Äúcontrato‚Äù ‚Üí should be ‚Äúcontracte‚Äù
   - ‚Äúlicitaci√≥n‚Äù ‚Üí should be ‚Äòlicitaci√≥‚Äô
   - ‚Äúadjudicaci√≥n‚Äù ‚Üí should be ‚Äúadjudicaci√≥‚Äù
   - ‚Äúenero, febrero...‚Äù ‚Üí should be ‚Äúgener, febrer...‚Äù
   - ‚Äúobras‚Äù ‚Üí should be ‚Äòobres‚Äô
   - ‚Äúproyecto‚Äù ‚Üí should be ‚Äúprojecte‚Äù

================================================================================
                              CRITICALITY LEVELS
================================================================================

üî¥ CRITICAL (Blocks generation):
- SAP tags not filled in
- Duplicate YES/NO fields
- Incorrect number of lots

üü° WARNING (Allows continuation):
- Incorrect date format
- Incorrect amount format
- Spanish words detected

================================================================================
                        INTEGRATION WITH VALIDATION
================================================================================

PROPOSED FLOW:
1. Receive document for validation
2. RUN validation for common errors (PRE-VALIDATION)
3. If there are critical errors ‚Üí Return list of errors immediately
4. If there are only warnings ‚Üí Continue with full structural validation
5. Include common errors in the final report

SUGGESTED RAG CONTEXT:
- Upload this file to context: ‚ÄúCOMMON_ERRORS_DOCUMENTS‚Äù
- Use to train automatic detection
- Update patterns according to new errors reported

================================================================================
                           SPECIFIC REGEX PATTERNS
================================================================================

UNFILLED SAP TAGS:
- /\{\{[^}]*\}\}/g
- /\[[^\]]*\]/g
- /<<[^>]*>>/g
- /@[^@]*@/g

DUPLICATED YES/NO FIELDS:
- /(\[X\]|\‚òë|X)\s*(YES|SI)[\s\S]*?(\[X\]|\‚òë|X)\s*(NO)/gi

INCORRECT DATES:
- /\d{4}-\d{2}-\d{2}/g (ISO)
- /\d{1,2}-\d{1,2}-\d{4}/g (hyphens)

INCORRECT AMOUNTS:
- /‚Ç¨\s*\d+/g (euro at the beginning)
- /\d+,\d{3}\.\d{2}/g (American format)

LOTS:
- /LOT?\s*(\d+)/gi
- /LOT\s*(\d+)/gi

SPANISH WORDS:
- /\b(budget|contract|tender|award|works|project)\b/gi

================================================================================
                           EXAMPLES OF ERRORS
================================================================================

‚ùå UNFILLED TAG:
‚ÄúThe total budget is {{TOTAL_AMOUNT}} euros.‚Äù

‚ùå YES/NO DUPLICATE:
"‚òë YES, lots are included.
‚òë NO, lots are not included."

‚ùå INCORRECT DATE:
‚ÄúDeadline: 2025-10-22‚Äù (should be ‚Äú10/22/2025‚Äù)

‚ùå INCORRECT AMOUNT:
‚ÄúBudget: ‚Ç¨123,456.78‚Äù (should be ‚Äú‚Ç¨123.456,78‚Äù)

‚ùå INCONSISTENT LOTS:
‚ÄúDivided into 3 lots‚Äù but only ‚ÄúLot 1‚Äù and ‚ÄúLot 2‚Äù appear

‚ùå INCORRECT LANGUAGE:
‚Äúpresupuesto de licitaci√≥n‚Äù (should be ‚Äúpressupost de licitaci√≥‚Äù)

================================================================================
                                    NOTES
================================================================================

- This system must be run BEFORE complete structural validation.
- Warnings are included in the report but do not block.
- Update patterns based on feedback from the specification generator.
- Keep statistics on the most frequent errors.

================================================================================
                                    END
================================================================================
