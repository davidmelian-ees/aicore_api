================================================================================
                        ERRORES COMUNES EN PLIEGOS SAP
                    Sistema de Validaci√≥n Pre-Informe
================================================================================

OBJETIVO:
Detectar autom√°ticamente errores frecuentes ANTES de generar el informe completo
de validaci√≥n estructural. Estos errores son reportados directamente por el
generador de pliegos y requieren validaci√≥n autom√°tica prioritaria.

================================================================================
                            ERRORES IDENTIFICADOS
================================================================================

1. CANTIDAD DE LOTES:
   ‚ùå PROBLEMA: Inconsistencia entre el n√∫mero de lotes declarados y los realmente incluidos
   
   VALIDACIONES:
   - Contar menciones de "LOTE" en el documento
   - Verificar numeraci√≥n secuencial (Lote 1, Lote 2, etc.)
   - Detectar lotes duplicados o saltos en numeraci√≥n
   - Validar que cada lote tenga presupuesto asignado
   
   PATRONES A DETECTAR:
   - "LOTE \d+" (Lote 1, Lote 2, etc.)
   - "Lot \d+" (variante catalana)
   - Tablas con columnas de lotes
   - Presupuestos por lote

2. TAGS SAP SIN RELLENAR:
   ‚ùå PROBLEMA: Tags de variables SAP que no fueron reemplazados con datos reales
   
   VALIDACIONES:
   - Buscar patrones {{VARIABLE}}
   - Detectar [CAMPO_PENDIENTE]
   - Encontrar <<DATO_FALTANTE>>
   - Identificar {VALOR_VACIO}
   - Localizar @VARIABLE_SAP@
   
   PATRONES CR√çTICOS:
   - {{.*?}} (cualquier contenido entre llaves dobles)
   - \[.*?\] (contenido entre corchetes)
   - <<.*?>> (contenido entre dobles menor/mayor)
   - @.*?@ (contenido entre arrobas)
   - {.*?} (contenido entre llaves simples)

3. CAMPOS S√ç/NO DUPLICADOS:
   ‚ùå PROBLEMA: Marcar tanto S√ç como NO en campos excluyentes
   
   VALIDACIONES:
   - Detectar "‚òë S√ç" y "‚òë NO" en la misma secci√≥n
   - Buscar "X S√ç" y "X NO" simult√°neos
   - Identificar "[X] S√ç" y "[X] NO" marcados
   - Validar checkboxes duplicados en formularios
   
   PATRONES A DETECTAR:
   - (\[X\]|\‚òë|X)\s*(S√ç|SI).*?(\[X\]|\‚òë|X)\s*(NO)
   - Campos con ambas opciones marcadas
   - Secciones con respuestas contradictorias

4. FORMATO DE FECHA INCORRECTO:
   ‚ùå PROBLEMA: Fechas en formato incorrecto o inconsistente
   
   FORMATO CORRECTO CATAL√ÅN: DD/MM/AAAA
   
   VALIDACIONES:
   - Detectar fechas en formato americano (MM/DD/AAAA)
   - Identificar fechas con guiones (DD-MM-AAAA)
   - Validar fechas con formato ISO (AAAA-MM-DD)
   - Verificar fechas en ingl√©s (Month DD, YYYY)
   
   PATRONES INCORRECTOS:
   - \d{4}-\d{2}-\d{2} (formato ISO)
   - \d{1,2}-\d{1,2}-\d{4} (con guiones)
   - [A-Za-z]+ \d{1,2}, \d{4} (formato ingl√©s)
   - Fechas con meses en ingl√©s

5. FORMATO DE IMPORTES INCORRECTO:
   ‚ùå PROBLEMA: Importes sin formato euro correcto o con separadores incorrectos
   
   FORMATO CORRECTO: 123.456,78 ‚Ç¨ (punto miles, coma decimales)
   
   VALIDACIONES:
   - Detectar formato americano: 123,456.78 (coma miles, punto decimales)
   - Identificar ‚Ç¨ al inicio en lugar del final
   - Validar separadores incorrectos
   - Verificar espacios entre n√∫mero y s√≠mbolo
   
   PATRONES INCORRECTOS:
   - ‚Ç¨\s*\d+ (euro al inicio)
   - \d+,\d{3}\.\d{2} (formato americano)
   - \d+‚Ç¨ (sin espacio antes del euro)
   - EUR en lugar de ‚Ç¨

6. IDIOMA INCORRECTO (NO CATAL√ÅN):
   ‚ùå PROBLEMA: Texto en castellano o otros idiomas en lugar de catal√°n
   
   VALIDACIONES:
   - Detectar palabras en castellano comunes
   - Identificar t√©rminos t√©cnicos no traducidos
   - Validar nombres de meses en catal√°n
   - Verificar terminolog√≠a legal catalana
   
   PALABRAS CASTELLANAS COMUNES A DETECTAR:
   - "presupuesto" ‚Üí debe ser "pressupost"
   - "contrato" ‚Üí debe ser "contracte"
   - "licitaci√≥n" ‚Üí debe ser "licitaci√≥"
   - "adjudicaci√≥n" ‚Üí debe ser "adjudicaci√≥"
   - "enero, febrero..." ‚Üí debe ser "gener, febrer..."
   - "obras" ‚Üí debe ser "obres"
   - "proyecto" ‚Üí debe ser "projecte"

7. NUMERACI√ìN SECUENCIAL INCORRECTA:
   ‚ùå PROBLEMA: Saltos en la numeraci√≥n de puntos del pliego
   
   VALIDACIONES:
   - Detectar saltos en numeraci√≥n principal (ej: 1. 2. 4. ‚Üê falta el 3.)
   - Verificar subnumeraci√≥n correcta (ej: 3.1, 3.2, 3.3)
   - Validar jerarqu√≠a de niveles (ej: 3.1.1, 3.1.2)
   - Alertar sobre posibles puntos faltantes
   
   EJEMPLOS CORRECTOS:
   ‚úÖ 1.
   ‚úÖ 2.
   ‚úÖ 3.
   ‚úÖ 3.1
   ‚úÖ 3.1.1
   ‚úÖ 3.1.2
   ‚úÖ 3.2
   ‚úÖ 4.
   
   EJEMPLOS INCORRECTOS:
   ‚ùå 1.
   ‚ùå 4. ‚Üê FALTA 2. y 3.
   
   ‚ùå 3.
   ‚ùå 3.1
   ‚ùå 3.3 ‚Üê FALTA 3.2
   
   SEVERIDAD:
   - Salto de 1 punto: ‚ö†Ô∏è ADVERTENCIA (puede ser intencional)
   - Salto de 2+ puntos: üî¥ ERROR CR√çTICO (probablemente faltan secciones)

8. TABLAS APLICA/NO APLICA INCOMPLETAS:
   ‚ùå PROBLEMA: Campos vac√≠os en tablas que requieren "APLICA" o "NO APLICA"
   
   ‚ö†Ô∏è INSTRUCCI√ìN CR√çTICA PARA LA IA:
   DEBES CONTAR LAS COLUMNAS "APLICA" Y "NO APLICA" EN CADA FILA.
   CADA FILA DEBE TENER EXACTAMENTE 2 VALORES (UNO EN CADA COLUMNA).
   SI UNA FILA TIENE SOLO 1 VALOR O M√ÅS DE 2, ES UN ERROR CR√çTICO.
   
   PROCESO DE VALIDACI√ìN PASO A PASO:
   
   PASO 1: Identificar tablas con encabezados "APLICA" y "NO APLICA"
   PASO 2: Para CADA fila de la tabla:
           - Contar cu√°ntos valores "APLICA" hay
           - Contar cu√°ntos valores "NO APLICA" hay
           - Contar cu√°ntos campos vac√≠os hay
   PASO 3: Validar que cada fila tenga EXACTAMENTE:
           - 1 valor en columna APLICA (puede ser "APLICA" o vac√≠o)
           - 1 valor en columna NO APLICA (puede ser "NO APLICA" o vac√≠o)
           - TOTAL: 2 columnas, al menos 1 debe tener valor
   PASO 4: Reportar filas con:
           - Ambas columnas vac√≠as (ERROR CR√çTICO)
           - Solo 1 columna cuando deber√≠a haber 2 (ERROR CR√çTICO)
           - Ambas columnas con valor (ERROR CR√çTICO - excluyentes)
   
   EJEMPLO REAL DE ERROR (DEBES DETECTAR ESTO):
   
   Texto del pliego:
   "1.03 Comprom√≠s sobre subcontractaci√≥    APLICA    APLICA
    1.04 Comprom√≠s sobre emissions CO2eq    APLICA
    1.05 Declaracions Ambientals            APLICA    APLICA
    1.06 Utilitzaci√≥ de fusta certificada   APLICA"
   
   AN√ÅLISIS QUE DEBES HACER:
   
   Fila 1.03: "APLICA" + "APLICA" = 2 valores ‚úÖ CORRECTO
   Fila 1.04: "APLICA" + [VAC√çO] = 1 valor ‚ùå ERROR (falta columna NO APLICA)
   Fila 1.05: "APLICA" + "APLICA" = 2 valores ‚úÖ CORRECTO
   Fila 1.06: "APLICA" + [VAC√çO] = 1 valor ‚ùå ERROR (falta columna NO APLICA)
   
   REPORTE QUE DEBES GENERAR:
   "üî¥ ERROR CR√çTICO: Tabla APLICA/NO APLICA incompleta
    
    Las siguientes filas tienen campos vac√≠os:
    
    ‚Ä¢ Fila 1.04 (Comprom√≠s sobre emissions CO2eq):
      - Columna APLICA: APLICA ‚úì
      - Columna NO APLICA: [VAC√çO] ‚ùå
      Debe tener valor en ambas columnas o marcar solo una
    
    ‚Ä¢ Fila 1.06 (Utilitzaci√≥ de fusta certificada):
      - Columna APLICA: APLICA ‚úì
      - Columna NO APLICA: [VAC√çO] ‚ùå
      Debe tener valor en ambas columnas o marcar solo una"
   
   PATRONES A DETECTAR:
   - Tablas con encabezados "APLICA" o "NO APLICA"
   - Filas con solo 1 valor cuando la tabla tiene 2 columnas
   - Celdas vac√≠as en columnas de aplicabilidad
   - Valores incorrectos (ej: "S√ç", "NO", "N/A" en lugar de "APLICA"/"NO APLICA")
   
   EJEMPLOS CORRECTOS:
   ‚úÖ | Criterio | APLICA | NO APLICA |
      | 1.01     | APLICA | APLICA    | ‚Üê Ambas columnas con valor
      | 1.02     | APLICA | APLICA    | ‚Üê Ambas columnas con valor
   
   ‚úÖ | Criterio | APLICA | NO APLICA |
      | 1.01     |   X    |           | ‚Üê Solo APLICA marcado
      | 1.02     |        |     X     | ‚Üê Solo NO APLICA marcado
   
   EJEMPLOS INCORRECTOS:
   ‚ùå | Criterio | APLICA | NO APLICA |
      | 1.01     | APLICA | APLICA    | ‚Üê OK
      | 1.02     | APLICA |           | ‚Üê ERROR: Falta valor en NO APLICA
      | 1.03     | APLICA | APLICA    | ‚Üê OK
      | 1.04     | APLICA |           | ‚Üê ERROR: Falta valor en NO APLICA
   
   ‚ùå | Criterio | APLICA | NO APLICA |
      | 1.01     |        |           | ‚Üê ERROR: Ambas vac√≠as
      | 1.02     |   X    |     X     | ‚Üê ERROR: Ambas marcadas (excluyentes)
   
   VALIDACIONES ESPEC√çFICAS:
   - Contar columnas en el encabezado de la tabla
   - Contar valores en cada fila
   - Comparar: ¬øn√∫mero de valores en fila == n√∫mero de columnas?
   - Si NO coincide: ERROR CR√çTICO
   - Identificar exactamente qu√© filas tienen el problema
   - Reportar n√∫mero de fila y nombre del criterio afectado
   
   SEVERIDAD:
   - Campo vac√≠o en tabla de 2 columnas: üî¥ ERROR CR√çTICO
   - Fila con solo 1 valor cuando tabla tiene 2 columnas: üî¥ ERROR CR√çTICO
   - Ambas columnas vac√≠as: üî¥ ERROR CR√çTICO
   - Ambas columnas marcadas (excluyentes): üî¥ ERROR CR√çTICO
   - Valor incorrecto (S√ç/NO en lugar de APLICA): üü° ADVERTENCIA

9. SECCIONES OBLIGATORIAS FALTANTES:
   ‚ùå PROBLEMA: Faltan apartados obligatorios seg√∫n el tipo de pliego
   
   SECCIONES OBLIGATORIAS EN TODOS LOS PLIEGOS:
   - OBJETO DEL CONTRATO
   - PRESUPUESTO
   - PLAZO DE EJECUCI√ìN
   - CONDICIONES T√âCNICAS
   - CRITERIOS DE ADJUDICACI√ìN
   - GARANT√çAS
   - PENALIDADES
   - MODIFICACI√ìN DEL CONTRATO
   - SUBCONTRATACI√ìN
   - REVISI√ìN DE PRECIOS
   
   VALIDACIONES:
   - Verificar presencia de todas las secciones obligatorias
   - Detectar secciones con contenido vac√≠o
   - Validar que las secciones est√©n en orden l√≥gico
   - Identificar secciones duplicadas
   
   SEVERIDAD:
   - Secci√≥n obligatoria faltante: üî¥ ERROR CR√çTICO
   - Secci√≥n vac√≠a: üü° ADVERTENCIA
   - Secci√≥n duplicada: üü° ADVERTENCIA
   - Orden incorrecto: üü° ADVERTENCIA

10. INCOHERENCIA NUM√âRICA EN PRESUPUESTOS Y LOTES:
    ‚ùå PROBLEMA: Las sumas de lotes no coinciden con el presupuesto total declarado
    
    ‚ö†Ô∏è INSTRUCCI√ìN CR√çTICA PARA LA IA:
    DEBES REALIZAR C√ÅLCULOS MATEM√ÅTICOS EXPL√çCITOS. NO ASUMAS QUE LOS N√öMEROS SON CORRECTOS.
    EXTRAE CADA N√öMERO, S√öMALOS MANUALMENTE Y COMPARA CON EL TOTAL DECLARADO.
    
    PROCESO PASO A PASO OBLIGATORIO:
    
    PASO 1: Buscar la l√≠nea "PRESSUPOST DE LICITACI√ì" o "PRESUPUESTO DE LICITACI√ìN"
    PASO 2: Extraer el importe total con IVA incluido (primer n√∫mero)
    PASO 3: Extraer el importe total sin IVA (segundo n√∫mero despu√©s de la coma)
    PASO 4: Buscar la tabla de lotes inmediatamente despu√©s
    PASO 5: Extraer TODOS los importes de la columna "Pressupost euros (IVA incl√≤s)"
    PASO 6: SUMAR manualmente todos los importes de lotes (con IVA)
    PASO 7: COMPARAR: suma_lotes vs presupuesto_total_declarado
    PASO 8: CALCULAR diferencia absoluta: |presupuesto_declarado - suma_lotes|
    PASO 9: REPORTAR si diferencia > 0.50‚Ç¨
    
    EJEMPLO REAL DE ERROR (DEBES DETECTAR ESTO):
    
    Texto del pliego:
    "PRESSUPOST DE LICITACI√ì: 243.936,00 euros (IVA incl√≤s), 201.600,00 euros (IVA no incl√≤s)
     
     Lot | Descripci√≥                      | Pressupost (IVA incl√≤s) | TOTAL (IVA no incl√≤s)
     1   | Carretera de Rub√≠ al Papiol     | 241.840,28             | 200.694,44
     2   | Carretera del Papiol a Mira-Sol | 1.942,72               | 1.605,56"
    
    AN√ÅLISIS QUE DEBES HACER:
    
    1. Presupuesto declarado (IVA incl√≤s): 243.936,00 euros
    2. Importes de lotes extra√≠dos:
       - Lot 1: 241.840,28 euros
       - Lot 2: 1.942,72 euros
    3. SUMA MANUAL: 241.840,28 + 1.942,72 = 243.783,00 euros
    4. COMPARACI√ìN: 243.936,00 (declarado) vs 243.783,00 (suma real)
    5. DIFERENCIA: 243.936,00 - 243.783,00 = 153,00 euros
    6. CONCLUSI√ìN: ERROR CR√çTICO (diferencia > 100‚Ç¨)
    
    REPORTE QUE DEBES GENERAR:
    "üî¥ ERROR CR√çTICO: Incoherencia num√©rica en presupuesto de licitaci√≥n
     
     Presupuesto declarado: 243.936,00‚Ç¨ (IVA incl√≤s)
     Suma de lotes: 243.783,00‚Ç¨
     Diferencia: 153,00‚Ç¨
     
     Detalle de lotes:
     - Lot 1: 241.840,28‚Ç¨
     - Lot 2: 1.942,72‚Ç¨
     - SUMA: 243.783,00‚Ç¨
     
     El presupuesto declarado NO coincide con la suma de lotes.
     Posible error en el importe del Lot 2 (deber√≠a ser 2.095,72‚Ç¨ en lugar de 1.942,72‚Ç¨)"
    
    EJEMPLO CORRECTO (para comparaci√≥n):
    ‚úÖ PRESSUPOST DE LICITACI√ì: 243.936,00 euros (IVA incl√≤s)
       Lot 1: 241.840,28 euros
       Lot 2: 2.095,72 euros
       SUMA: 241.840,28 + 2.095,72 = 243.936,00 euros ‚Üê COINCIDE EXACTAMENTE
    
    PATRONES A DETECTAR:
    - "PRESSUPOST DE LICITACI√ì:" o "PRESUPUESTO DE LICITACI√ìN:"
    - Tablas con columnas "Lot", "Lote", "Pressupost", "Presupuesto"
    - Importes en formato: 123.456,78 euros
    - Menciones "(IVA incl√≤s)" o "(IVA no incl√≤s)"
    
    VALIDACIONES ESPEC√çFICAS:
    - Extraer presupuesto total con IVA incluido
    - Extraer presupuesto total sin IVA
    - Sumar lotes con IVA incluido
    - Sumar lotes sin IVA
    - Comparar ambas sumas (con IVA y sin IVA)
    - Validar que diferencia sea < 0.50‚Ç¨ (tolerancia por redondeos)
    
    C√ÅLCULOS A REALIZAR:
    1. Identificar secci√≥n "DADES ECON√íMIQUES" o "DATOS ECON√ìMICOS"
    2. Extraer l√≠nea con "PRESSUPOST DE LICITACI√ì" o similar
    3. Extraer dos importes: (IVA incl√≤s) y (IVA no incl√≤s)
    4. Buscar tabla de lotes posterior
    5. Extraer todos los importes de la columna de presupuesto
    6. Sumar importes de lotes
    7. Comparar: |suma_lotes - presupuesto_total| < 0.50‚Ç¨
    
    SEVERIDAD:
    - Diferencia > 100‚Ç¨: üî¥ ERROR CR√çTICO (error de c√°lculo grave)
    - Diferencia 1‚Ç¨ - 100‚Ç¨: üü° ADVERTENCIA (posible error de redondeo)
    - Diferencia < 1‚Ç¨: ‚úÖ CORRECTO (tolerancia aceptable)
    - Falta tabla de lotes cuando se declaran lotes: üî¥ ERROR CR√çTICO
    - N√∫mero de lotes en tabla ‚â† n√∫mero declarado: üî¥ ERROR CR√çTICO

11. COMENTARIOS DE DESARROLLADORES Y TAGS SAP SIN REEMPLAZAR:
    PROBLEMA: El pliego contiene comentarios de desarrollo o tags SAP sin reemplazar

12. FORMATO DE IMPORTES INCONSISTENTE:
    ‚ùå PROBLEMA: Los importes monetarios aparecen con formatos diferentes a lo largo del documento
    
    ‚ö†Ô∏è INSTRUCCI√ìN CR√çTICA PARA LA IA:
    TODOS LOS IMPORTES DEBEN SEGUIR EL MISMO FORMATO EST√ÅNDAR.
    DEBES VERIFICAR CADA IMPORTE Y REPORTAR INCONSISTENCIAS.
    
    FORMATO EST√ÅNDAR CORRECTO:
    - Separador de miles: Punto (.)
    - Separador decimal: Coma (,)
    - Decimales: Siempre 2 d√≠gitos (,00)
    - S√≠mbolo: ‚Ç¨ con espacio antes
    - Ejemplo: 2.450.000,00 ‚Ç¨
    
    PROCESO DE VALIDACI√ìN PASO A PASO:
    
    PASO 1: Buscar TODOS los importes monetarios en el documento
    PASO 2: Para CADA importe encontrado, verificar:
            - ¬øTiene separador de miles (punto)?
            - ¬øTiene separador decimal (coma)?
            - ¬øTiene exactamente 2 decimales?
            - ¬øTiene s√≠mbolo ‚Ç¨ con espacio antes?
    PASO 3: Identificar importes con formato diferente
    PASO 4: Listar TODOS los importes incorrectos con su ubicaci√≥n
    
    EJEMPLOS DE FORMATOS INCORRECTOS:
    
    ‚ùå 2450000 (sin separadores ni s√≠mbolo)
    ‚ùå 2.450.000 (sin decimales ni s√≠mbolo)
    ‚ùå 2.450.000 EUR (EUR en lugar de ‚Ç¨)
    ‚ùå 2.450.000,00‚Ç¨ (sin espacio antes de ‚Ç¨)
    ‚ùå ‚Ç¨2.450.000,00 (‚Ç¨ al inicio)
    ‚ùå 2,450,000.00 ‚Ç¨ (formato americano)
    ‚ùå 2.450.000.00 ‚Ç¨ (punto como decimal)
    
    EJEMPLOS CORRECTOS:
    ‚úÖ 2.450.000,00 ‚Ç¨
    ‚úÖ 150,50 ‚Ç¨
    ‚úÖ 1.234.567,89 ‚Ç¨
    ‚úÖ 0,00 ‚Ç¨
    
    REPORTE QUE DEBES GENERAR:
    "üü° ADVERTENCIA: Formato de importes inconsistente
     
     Los siguientes importes no siguen el formato est√°ndar (X.XXX.XXX,XX ‚Ç¨):
     
     ‚Ä¢ Secci√≥n 'PRESUPUESTO': 2.450.000 EUR
       Formato correcto: 2.450.000,00 ‚Ç¨
     
     ‚Ä¢ Tabla de lotes, Lote 2: 150.50‚Ç¨
       Formato correcto: 150,50 ‚Ç¨
     
     ‚Ä¢ P√°gina 5, p√°rrafo 3: ‚Ç¨1.234.567,89
       Formato correcto: 1.234.567,89 ‚Ç¨"
    
    PATRONES A DETECTAR:
    - Importes sin decimales: \d{1,3}(?:\.\d{3})* (sin ,\d{2})
    - ‚Ç¨ al inicio: ‚Ç¨\s*\d+
    - Sin espacio antes de ‚Ç¨: \d+‚Ç¨
    - EUR en lugar de ‚Ç¨: \d+.*?EUR
    - Formato americano: \d{1,3}(?:,\d{3})*\.\d{2}
    - Punto como decimal: \d+\.\d{2}\s*‚Ç¨
    
    SEVERIDAD:
    - Formato inconsistente: üü° ADVERTENCIA
    - M√°s de 5 importes incorrectos: üî¥ ERROR CR√çTICO

13. VALORES 0,00 ‚Ç¨ EN TABLAS SIN RELLENAR:
    ‚ùå PROBLEMA: Tablas con valores "0,00 ‚Ç¨" indican datos sin completar o plantillas sin rellenar
    
    ‚ö†Ô∏è INSTRUCCI√ìN CR√çTICA PARA LA IA:
    LOS VALORES "0,00 ‚Ç¨" EN TABLAS DE PRESUPUESTOS INDICAN DATOS INCOMPLETOS.
    DEBES DETECTAR PATRONES DE TABLAS VAC√çAS O SIN COMPLETAR.
    
    PROCESO DE VALIDACI√ìN PASO A PASO:
    
    PASO 1: Buscar TODAS las tablas con columnas de importes monetarios
    PASO 2: Para CADA tabla, identificar filas con valores "0,00 ‚Ç¨"
    PASO 3: Contar cu√°ntas filas consecutivas tienen "0,00 ‚Ç¨"
    PASO 4: Verificar si la fila TOTAL tiene "0,00 ‚Ç¨"
    PASO 5: Reportar tablas con datos incompletos
    
    PATRONES CR√çTICOS A DETECTAR:
    
    1. FILA TOTAL CON 0,00 ‚Ç¨:
       Si la fila "TOTAL" tiene "0,00 ‚Ç¨" en todas las columnas ‚Üí ERROR CR√çTICO
       Indica que la tabla completa est√° vac√≠a
    
    2. M√öLTIPLES FILAS CONSECUTIVAS CON 0,00 ‚Ç¨:
       Si 3+ filas consecutivas tienen "0,00 ‚Ç¨" ‚Üí ERROR CR√çTICO
       Indica secci√≥n de tabla sin completar
    
    3. TABLA DE LOTES CON C√ìDIGO "000":
       Si aparece "Lot: 000" o "Lote: 000" ‚Üí ERROR CR√çTICO
       Indica lote placeholder sin eliminar
    
    4. DESCRIPCI√ìN VAC√çA CON 0,00 ‚Ç¨:
       Si descripci√≥n est√° vac√≠a Y importe es "0,00 ‚Ç¨" ‚Üí ERROR CR√çTICO
       Indica fila sin datos
    
    EJEMPLOS REALES DE ERRORES:
    
    ERROR 1 - Tabla de lotes vac√≠a:
    "| Lot | Descripci√≥ de lot |
     | 000 |                   |"
    
    REPORTE ESPERADO:
    "üî¥ ERROR CR√çTICO: Tabla de lotes con c√≥digo placeholder
     - Lote con c√≥digo '000' detectado
     - Descripci√≥n vac√≠a
     - Debe eliminarse o completarse con datos reales"
    
    ERROR 2 - Tabla de presupuesto con ceros:
    "| Lot | Descripci√≥ | Import base ‚Ç¨ | IVA ‚Ç¨ | Import total ‚Ç¨ (IVA incl√≤s) |
     |     | TOTAL      | 0,00 ‚Ç¨        | 0,00 ‚Ç¨| 0,00 ‚Ç¨                      |"
    
    REPORTE ESPERADO:
    "üî¥ ERROR CR√çTICO: Tabla de presupuesto sin completar
     - Fila TOTAL tiene todos los valores en 0,00 ‚Ç¨
     - Indica tabla vac√≠a o sin datos
     - Debe completarse con importes reales"
    
    ERROR 3 - M√∫ltiples lotes vac√≠os:
    "| Lot | Descripci√≥ | Pressupost (IVA incl√≤s) |
     | 1   | Obra 1     | 150.000,00 ‚Ç¨            |
     | 2   | Obra 2     | 0,00 ‚Ç¨                  |
     | 3   | Obra 3     | 0,00 ‚Ç¨                  |
     | 4   | Obra 4     | 0,00 ‚Ç¨                  |"
    
    REPORTE ESPERADO:
    "üî¥ ERROR CR√çTICO: M√∫ltiples lotes sin presupuesto
     - Lotes 2, 3, 4 tienen presupuesto 0,00 ‚Ç¨
     - 3 lotes consecutivos sin completar
     - Deben eliminarse o completarse con importes reales"
    
    EXCEPCIONES (NO REPORTAR):
    
    ‚úÖ Si el documento expl√≠citamente indica:
       - "Sin presupuesto asignado"
       - "Presupuesto pendiente de aprobaci√≥n"
       - "Importe a determinar"
       - Entonces NO reportar como error
    
    ‚úÖ Si solo 1-2 filas aisladas tienen 0,00 ‚Ç¨:
       - Puede ser intencional (lotes opcionales)
       - Reportar como üü° ADVERTENCIA en lugar de ERROR
    
    PATRONES REGEX:
    - Valores cero: 0,00\s*‚Ç¨|0\.00\s*‚Ç¨
    - C√≥digo placeholder: (Lot|Lote)\s*[:|]\s*000
    - Fila TOTAL: TOTAL.*?0,00\s*‚Ç¨
    - M√∫ltiples ceros: (0,00\s*‚Ç¨.*?){3,}
    
    SEVERIDAD:
    - Fila TOTAL con 0,00 ‚Ç¨: üî¥ ERROR CR√çTICO
    - 3+ filas consecutivas con 0,00 ‚Ç¨: üî¥ ERROR CR√çTICO
    - C√≥digo "000" en lotes: üî¥ ERROR CR√çTICO
    - 1-2 filas aisladas con 0,00 ‚Ç¨: üü° ADVERTENCIA

14. BULLETS VAC√çOS O PERDIDOS:
    ‚ùå PROBLEMA: Listas con bullets vac√≠os (sin contenido despu√©s del punto) o con estructura inconsistente
    
    ‚ö†Ô∏è INSTRUCCI√ìN CR√çTICA PARA LA IA:
    LOS BULLETS VAC√çOS INDICAN CONTENIDO FALTANTE O ERRORES DE FORMATO.
    DEBES DETECTAR VI√ëETAS SIN TEXTO ASOCIADO.
    
    PROCESO DE VALIDACI√ìN PASO A PASO:
    
    PASO 1: Buscar TODAS las listas con vi√±etas (‚Ä¢, ‚óã, -, n√∫meros, letras)
    PASO 2: Para CADA lista, verificar:
            - ¬øHay bullets sin texto despu√©s?
            - ¬øHay saltos de l√≠nea con bullet pero sin contenido?
            - ¬øHay bullets seguidos sin texto entre ellos?
    PASO 3: Identificar el tipo de bullet (letra, n√∫mero, s√≠mbolo)
    PASO 4: Reportar bullets vac√≠os con su ubicaci√≥n exacta
    
    PATRONES CR√çTICOS A DETECTAR:
    
    1. BULLET SEGUIDO DE OTRO BULLET SIN TEXTO:
       Patr√≥n: "o\n\no Texto" ‚Üí Primer "o" est√° vac√≠o
       Patr√≥n: "‚Ä¢\n‚Ä¢" ‚Üí Primer bullet vac√≠o
       Patr√≥n: "-\n-" ‚Üí Primer guion vac√≠o
    
    2. NUMERACI√ìN VAC√çA:
       Patr√≥n: "1.\n2. Texto" ‚Üí Punto 1 vac√≠o
       Patr√≥n: "a)\nb) Texto" ‚Üí Letra a) vac√≠a
    
    3. BULLET CON SOLO ESPACIOS:
       Patr√≥n: "‚Ä¢ \n‚Ä¢ Texto" ‚Üí Primer bullet solo tiene espacios
       Patr√≥n: "- \n- Texto" ‚Üí Primer guion solo tiene espacios
    
    4. INDENTACI√ìN INCORRECTA:
       Bullet padre sin texto pero con bullets hijos
       Indica estructura de lista mal formada
    
    EJEMPLO REAL DE ERROR (de las im√°genes del cliente):
    
    ERROR 1 - Bullet vac√≠o en lista:
    "c) Les obligacions d'informaci√≥ del Contractista...
         Plec de Cl√†usules Administratives Particulars...
         o
         o Aplicable al contracte si l'import de subcontractaci√≥ √©s igual o superior al 30%
           del preu del contracte"
    
    AN√ÅLISIS:
    - Primer "o" est√° vac√≠o (sin texto despu√©s)
    - Segundo "o" tiene texto completo
    - El primer bullet debe eliminarse o completarse
    
    REPORTE ESPERADO:
    "üî¥ ERROR CR√çTICO: Bullet vac√≠o detectado
     
     Secci√≥n: 'c) Les obligacions d'informaci√≥ del Contractista'
     
     Estructura actual:
     o [VAC√çO]
     o Aplicable al contracte si l'import...
     
     Acci√≥n requerida:
     - Eliminar el primer bullet vac√≠o
     - O completar con el texto correspondiente"
    
    ERROR 2 - Numeraci√≥n con punto vac√≠o:
    "18. GARANTIES
     18.1
     18.2 Garantia provisional
     18.3 Garantia definitiva"
    
    REPORTE ESPERADO:
    "üî¥ ERROR CR√çTICO: Punto de numeraci√≥n vac√≠o
     
     Secci√≥n: '18. GARANTIES'
     Punto vac√≠o: 18.1 (sin texto despu√©s)
     
     Puntos siguientes:
     18.2 Garantia provisional
     18.3 Garantia definitiva
     
     Acci√≥n requerida:
     - Eliminar punto 18.1 vac√≠o
     - O renumerar: 18.1 Garantia provisional, 18.2 Garantia definitiva"
    
    ERROR 3 - Lista con m√∫ltiples bullets vac√≠os:
    "Criteris de valoraci√≥:
     ‚Ä¢
     ‚Ä¢
     ‚Ä¢ Experi√®ncia en projectes similars
     ‚Ä¢ Capacitat t√®cnica"
    
    REPORTE ESPERADO:
    "üî¥ ERROR CR√çTICO: M√∫ltiples bullets vac√≠os
     
     Secci√≥n: 'Criteris de valoraci√≥'
     Bullets vac√≠os detectados: 2
     
     Estructura actual:
     ‚Ä¢ [VAC√çO]
     ‚Ä¢ [VAC√çO]
     ‚Ä¢ Experi√®ncia en projectes similars
     ‚Ä¢ Capacitat t√®cnica
     
     Acci√≥n requerida:
     - Eliminar los 2 bullets vac√≠os
     - Verificar si falta contenido"
    
    PATRONES REGEX PARA DETECCI√ìN:
    
    1. Bullets circulares:
       - /^[‚óão]\s*$/gm (bullet vac√≠o)
       - /^[‚óão]\s*\n\s*[‚óão]/gm (dos bullets seguidos)
    
    2. Bullets con guion:
       - /^-\s*$/gm (guion vac√≠o)
       - /^-\s*\n\s*-/gm (dos guiones seguidos)
    
    3. Bullets con punto:
       - /^‚Ä¢\s*$/gm (punto vac√≠o)
       - /^‚Ä¢\s*\n\s*‚Ä¢/gm (dos puntos seguidos)
    
    4. Numeraci√≥n:
       - /^\d+\.\s*$/gm (n√∫mero vac√≠o)
       - /^\d+\.\s*\n\s*\d+\./gm (n√∫meros seguidos sin texto)
    
    5. Letras:
       - /^[a-z]\)\s*$/gm (letra vac√≠a)
       - /^[a-z]\)\s*\n\s*[a-z]\)/gm (letras seguidas sin texto)
    
    VALIDACIONES ESPEC√çFICAS:
    
    1. Contar bullets en la lista
    2. Para cada bullet, verificar si tiene texto despu√©s
    3. Medir longitud del texto (debe ser > 3 caracteres)
    4. Verificar que no sea solo espacios o saltos de l√≠nea
    5. Identificar posici√≥n exacta del bullet vac√≠o
    6. Reportar con contexto (secci√≥n, subsecci√≥n)
    
    EXCEPCIONES (NO REPORTAR):
    
    ‚úÖ Bullets intencionalmente vac√≠os con nota:
       "‚Ä¢ (Pendiente de completar)"
       "‚Ä¢ [A determinar]"
       "‚Ä¢ N/A"
    
    ‚úÖ Listas con formato especial:
       Tablas con bullets como separadores visuales
    
    SEVERIDAD:
    - 1 bullet vac√≠o: üî¥ ERROR CR√çTICO
    - 2+ bullets vac√≠os: üî¥ ERROR CR√çTICO (alta prioridad)
    - Bullet con solo espacios: üî¥ ERROR CR√çTICO
    - Numeraci√≥n vac√≠a: üî¥ ERROR CR√çTICO

15. LOTES CON C√ìDIGO "000" SIN ELIMINAR:
    ‚ùå PROBLEMA: Filas de lotes con c√≥digo placeholder "000" que no fueron eliminadas de la plantilla
    
    ‚ö†Ô∏è INSTRUCCI√ìN CR√çTICA PARA LA IA:
    EL C√ìDIGO "000" ES UN PLACEHOLDER DE PLANTILLA QUE DEBE SER ELIMINADO.
    CUALQUIER LOTE CON C√ìDIGO "000" INDICA UNA PLANTILLA SIN LIMPIAR.
    
    PROCESO DE VALIDACI√ìN PASO A PASO:
    
    PASO 1: Buscar TODAS las tablas de lotes en el documento
    PASO 2: Para CADA tabla, buscar columna "Lot" o "Lote"
    PASO 3: Identificar filas con c√≥digo "000"
    PASO 4: Verificar si la fila tiene descripci√≥n vac√≠a
    PASO 5: Reportar todas las filas con c√≥digo "000"
    
    PATRONES CR√çTICOS A DETECTAR:
    
    1. C√ìDIGO "000" EN COLUMNA DE LOTE:
       | Lot | Descripci√≥ |
       | 000 | ...        |
       
       Indica: Fila placeholder sin eliminar
    
    2. C√ìDIGO "000" CON DESCRIPCI√ìN VAC√çA:
       | Lot | Descripci√≥ de lot |
       | 000 |                   |
       
       Indica: Fila completamente vac√≠a de plantilla
    
    3. C√ìDIGO "000" CON PRESUPUESTO 0,00 ‚Ç¨:
       | Lot | Descripci√≥ | Pressupost |
       | 000 | ...        | 0,00 ‚Ç¨     |
       
       Indica: Lote sin datos reales
    
    4. M√öLTIPLES FILAS CON "000":
       Indica: Plantilla con m√∫ltiples lotes placeholder sin limpiar
    
    EJEMPLO REAL DE ERROR (de las im√°genes del cliente):
    
    ERROR 1 - Lote con c√≥digo 000:
    "| Lot | Descripci√≥ de lot |
     | 000 |                   |"
    
    AN√ÅLISIS:
    - C√≥digo de lote: "000" (placeholder)
    - Descripci√≥n: vac√≠a
    - Esta fila debe eliminarse completamente
    
    REPORTE ESPERADO:
    "üî¥ ERROR CR√çTICO: Lote con c√≥digo placeholder detectado
     
     Tabla: Descripci√≥n de lotes
     Fila detectada:
     - C√≥digo lote: 000
     - Descripci√≥n: [VAC√çA]
     
     Acci√≥n requerida:
     - Eliminar completamente esta fila de la tabla
     - Es un placeholder de plantilla que no debe aparecer en el documento final"
    
    ERROR 2 - M√∫ltiples lotes 000:
    "| Lot | Descripci√≥ | Pressupost (IVA incl√≤s) |
     | 1   | Obra real  | 150.000,00 ‚Ç¨            |
     | 000 |            | 0,00 ‚Ç¨                  |
     | 000 |            | 0,00 ‚Ç¨                  |"
    
    REPORTE ESPERADO:
    "üî¥ ERROR CR√çTICO: M√∫ltiples lotes placeholder detectados
     
     Tabla: Presupuesto de lotes
     Lotes con c√≥digo '000': 2 filas
     
     Filas a eliminar:
     - Fila 2: Lot 000, sin descripci√≥n, 0,00 ‚Ç¨
     - Fila 3: Lot 000, sin descripci√≥n, 0,00 ‚Ç¨
     
     Acci√≥n requerida:
     - Eliminar ambas filas placeholder
     - Mantener solo lotes reales con datos completos"
    
    ERROR 3 - Lote 000 con descripci√≥n parcial:
    "| Lot | Descripci√≥        | Pressupost |
     | 1   | Carretera A       | 200.000 ‚Ç¨  |
     | 000 | [Pendiente]       | 0,00 ‚Ç¨     |
     | 2   | Carretera B       | 150.000 ‚Ç¨  |"
    
    REPORTE ESPERADO:
    "üî¥ ERROR CR√çTICO: Lote placeholder con descripci√≥n temporal
     
     Tabla: Lotes del proyecto
     Lote detectado: 000 - [Pendiente]
     
     Problema:
     - C√≥digo '000' es placeholder de plantilla
     - Descripci√≥n '[Pendiente]' indica dato incompleto
     - Presupuesto 0,00 ‚Ç¨ sin asignar
     
     Acci√≥n requerida:
     - Si el lote es real: asignar c√≥digo correcto (3) y completar datos
     - Si no es necesario: eliminar la fila completamente"
    
    PATRONES REGEX PARA DETECCI√ìN:
    
    1. C√≥digo 000 en tabla:
       - /(Lot|Lote)\s*[:|]\s*000/gi
       - /\|\s*000\s*\|/g (en formato tabla)
    
    2. Fila completa con 000:
       - /\|\s*000\s*\|[^|]*\|/g (captura fila completa)
    
    3. 000 con descripci√≥n vac√≠a:
       - /\|\s*000\s*\|\s*\|/g
    
    4. 000 con presupuesto cero:
       - /000.*?0,00\s*‚Ç¨/g
    
    VALIDACIONES ESPEC√çFICAS:
    
    1. Identificar todas las tablas de lotes
    2. Buscar columna "Lot" o "Lote"
    3. Para cada fila, extraer c√≥digo de lote
    4. Si c√≥digo == "000":
       - Verificar descripci√≥n (vac√≠a o con texto)
       - Verificar presupuesto (0,00 ‚Ç¨ o con valor)
       - Contar cu√°ntas filas tienen "000"
    5. Reportar con detalles completos
    
    CONTEXTO ADICIONAL:
    
    El c√≥digo "000" se usa en plantillas SAP como placeholder para:
    - Indicar "sin lotes" en documentos base
    - Marcar filas que deben eliminarse si no aplican
    - Separar secciones condicionales
    
    En documentos finales, NUNCA debe aparecer "000" como c√≥digo de lote real.
    
    EXCEPCIONES (NO REPORTAR):
    
    ‚ùå NO hay excepciones v√°lidas para este error
    ‚úÖ SIEMPRE reportar c√≥digo "000" como ERROR CR√çTICO
    
    Raz√≥n: "000" es SIEMPRE un placeholder de plantilla
    
    SEVERIDAD:
    - 1 lote con c√≥digo "000": üî¥ ERROR CR√çTICO
    - 2+ lotes con c√≥digo "000": üî¥ ERROR CR√çTICO (m√°xima prioridad)
    - "000" en cualquier contexto de lotes: üî¥ ERROR CR√çTICO
    
    INSTRUCCION CRITICA PARA LA IA:
    DEBES BUSCAR ACTIVAMENTE CUALQUIER TEXTO QUE PAREZCA SER:
    - Un comentario de un desarrollador
    - Una instruccion tecnica sobre que hacer
    - Una variable SAP sin reemplazar (empieza con Z)
    - Texto resaltado o con formato de borrador
    
    PATRONES A DETECTAR:
    
    1. COMENTARIOS DE DESARROLLADORES:
       - Texto con nombre + dos puntos: "Oriol:", "David:", "Maria:", "Joan:"
       - Instrucciones en catalan: "S'haura de treure", "no treure la taula", "Escollir quina de les 2"
       - Referencias a tablas SAP: "si hi ha valors a la taula ZRM_", "a la taula ZVRM_"
       - Condiciones tecnicas: "Si ZVRM_QDC_CLO_LIC-ZZ_NUM_LOT = 000", "En cas que apliqui"
       - Instrucciones sobre columnas: "quan no hi hagi lots, a la columna material"
    
    2. TAGS SAP SIN REEMPLAZAR (Variables que empiezan con Z):
       - ZRM_DM_MAT_CO2
       - ZVRM_QDC_MAT_LIC
       - ZVRM_QDC_CLO_LIC-ZZ_NUM_LOT
       - Cualquier variable: Z[A-Z_]+
    
    3. TEXTO RESALTADO CON INSTRUCCIONES:
       - Texto en amarillo con instrucciones
       - Texto en rojo con comentarios
       - Placeholders o borradores visibles
       - Instrucciones entre parentesis
    
    EJEMPLOS REALES DE ERRORES:
    
    ERROR 1:
    "Oriol: En cas que apliqui el CO2 (si hi ha valors a la taula ZRM_DM_MAT_CO2 o 
    ZVRM_QDC_MAT_LIC -> Escollir quina de les 2) S'haura de treure el text en groc."
    
    REPORTE ESPERADO:
    "ERROR CRITICO: Comentario de desarrollador detectado
     - Linea: 'Oriol: En cas que apliqui el CO2...'
     - Contiene: Nombre desarrollador + instrucciones tecnicas
     - Tags SAP sin reemplazar: ZRM_DM_MAT_CO2, ZVRM_QDC_MAT_LIC"
    
    ERROR 2:
    "Oriol: Si ZVRM_QDC_CLO_LIC-ZZ_NUM_LOT = 000 no treure la taula seguent"
    
    REPORTE ESPERADO:
    "ERROR CRITICO: Comentario de desarrollador detectado
     - Linea: 'Oriol: Si ZVRM_QDC_CLO_LIC-ZZ_NUM_LOT = 000...'
     - Contiene: Condicion tecnica SAP
     - Tag SAP sin reemplazar: ZVRM_QDC_CLO_LIC-ZZ_NUM_LOT"
    
    SEVERIDAD: ERROR CRITICO (bloquea generacion)

================================================================================
                        NIVELES DE CRITICIDAD
================================================================================

üî¥ CR√çTICO (Bloquea generaci√≥n):
- Tags SAP sin rellenar
- Comentarios de desarrolladores en el texto (Oriol:, David:, etc.)
- Tags SAP sin reemplazar (ZRM_, ZVRM_, etc.)
- Campos S√ç/NO duplicados
- Cantidad de lotes incorrecta
- Saltos de 2+ puntos en numeraci√≥n (probablemente faltan secciones)
- Tablas APLICA/NO APLICA con campos vac√≠os
- Tablas APLICA/NO APLICA con ambas opciones marcadas
- Secciones obligatorias faltantes
- Incoherencia num√©rica > 100‚Ç¨ entre presupuesto total y suma de lotes
- Falta tabla de lotes cuando se declaran lotes
- N√∫mero de lotes en tabla diferente al declarado
- Fila TOTAL con 0,00 ‚Ç¨ (Error #13 - Jes√∫s Arenas)
- 3+ filas consecutivas con 0,00 ‚Ç¨ (Error #13 - Jes√∫s Arenas)
- C√≥digo "000" en lotes (Error #13 y #15 - Jes√∫s Arenas)
- Bullets vac√≠os o sin texto (Error #14 - Jes√∫s Arenas)
- Numeraci√≥n vac√≠a (Error #14 - Jes√∫s Arenas)
- Lotes con c√≥digo placeholder "000" (Error #15 - Jes√∫s Arenas)

üü° ADVERTENCIA (Permite continuar):
- Formato de fecha incorrecto
- Formato de importes incorrecto
- Formato de importes inconsistente (Error #12 - Jes√∫s Arenas)
- 1-2 filas aisladas con 0,00 ‚Ç¨ (Error #13 - Jes√∫s Arenas)
- Palabras en castellano detectadas
- Salto de 1 punto en numeraci√≥n (puede ser intencional)
- Secciones vac√≠as
- Secciones duplicadas
- Orden incorrecto de secciones
- Valores no est√°ndar en tablas APLICA/NO APLICA
- Incoherencia num√©rica 1‚Ç¨-100‚Ç¨ entre presupuesto y lotes (posible redondeo)

================================================================================
                        INTEGRACI√ìN CON VALIDACI√ìN
================================================================================

FLUJO PROPUESTO:
1. Recibir documento para validaci√≥n
2. EJECUTAR validaci√≥n de errores comunes (PRE-VALIDACI√ìN)
3. Si hay errores cr√≠ticos ‚Üí Devolver lista de errores inmediatamente
4. Si solo hay advertencias ‚Üí Continuar con validaci√≥n estructural completa
5. Incluir errores comunes en el informe final

CONTEXTO RAG SUGERIDO:
- Subir este archivo a contexto: "ERRORES_COMUNES_PLIEGOS"
- Usar para entrenar detecci√≥n autom√°tica
- Actualizar patrones seg√∫n nuevos errores reportados

================================================================================
                        PATRONES REGEX ESPEC√çFICOS
================================================================================

TAGS SAP SIN RELLENAR:
- /\{\{[^}]*\}\}/g
- /\[[^\]]*\]/g
- /<<[^>]*>>/g
- /@[^@]*@/g

CAMPOS S√ç/NO DUPLICADOS:
- /(\[X\]|\‚òë|X)\s*(S√ç|SI)[\s\S]*?(\[X\]|\‚òë|X)\s*(NO)/gi

FECHAS INCORRECTAS:
- /\d{4}-\d{2}-\d{2}/g (ISO)
- /\d{1,2}-\d{1,2}-\d{4}/g (guiones)

IMPORTES INCORRECTOS:
- /‚Ç¨\s*\d+/g (euro al inicio)
- /\d+,\d{3}\.\d{2}/g (formato americano)

LOTES:
- /LOTE?\s*(\d+)/gi
- /LOT\s*(\d+)/gi

PALABRAS CASTELLANAS:
- /\b(presupuesto|contrato|licitaci√≥n|adjudicaci√≥n|obras|proyecto)\b/gi

COMENTARIOS DE DESARROLLADORES:
- /^[A-Z][a-z]+:\s+/gm (Oriol:, David:, Maria:)
- /S'haur√† de treure/gi
- /no treure/gi
- /Escollir quina de les/gi
- /si hi ha valors a la taula/gi

TAGS SAP SIN REEMPLAZAR (Variables Z):
- /\bZ[A-Z_]+[A-Z0-9_]*\b/g
- /ZVRM_[A-Z_]+/g
- /ZRM_[A-Z_]+/g

NUMERACI√ìN:
- /^(\d+(?:\.\d+)*)\.\s+/gm (detectar numeraci√≥n: 1., 2.1, 3.1.1, etc.)
- Validar secuencia: extraer n√∫meros y verificar continuidad

TABLAS APLICA/NO APLICA:
- /APLICA|NO APLICA/gi (detectar tablas con estos encabezados)
- /\|\s*\|\s*\|/g (detectar celdas vac√≠as en tablas)
- /APLICA:\s*$/gim (detectar campos APLICA vac√≠os)
- /NO APLICA:\s*$/gim (detectar campos NO APLICA vac√≠os)

SECCIONES OBLIGATORIAS:
- Buscar texto exacto (case-insensitive):
  - "OBJETO DEL CONTRATO" o "OBJECTE DEL CONTRACTE"
  - "PRESUPUESTO" o "PRESSUPOST"
  - "PLAZO DE EJECUCI√ìN" o "TERMINI D'EXECUCI√ì"
  - "CONDICIONES T√âCNICAS" o "CONDICIONS T√àCNIQUES"
  - "CRITERIOS DE ADJUDICACI√ìN" o "CRITERIS D'ADJUDICACI√ì"
  - "GARANT√çAS" o "GARANTIES"
  - "PENALIDADES" o "PENALITATS"
  - "MODIFICACI√ìN DEL CONTRATO" o "MODIFICACI√ì DEL CONTRACTE"
  - "SUBCONTRATACI√ìN" o "SUBCONTRACTACI√ì"
  - "REVISI√ìN DE PRECIOS" o "REVISI√ì DE PREUS"

COHERENCIA NUM√âRICA PRESUPUESTOS:
- /PRESSUPOST DE LICITACI√ì:\s*([\d.,]+)\s*euros\s*\(IVA incl√≤s\)/gi
- /PRESUPUESTO DE LICITACI√ìN:\s*([\d.,]+)\s*euros\s*\(IVA incluido\)/gi
- /Lot\s*\d+.*?([\d.,]+)\s*euros/gi (extraer importes de lotes)
- Convertir formato catal√°n (123.456,78) a n√∫mero para c√°lculos
- Sumar todos los importes de lotes
- Calcular diferencia absoluta: |presupuesto_total - suma_lotes|
- Clasificar seg√∫n diferencia: <1‚Ç¨ OK, 1-100‚Ç¨ WARNING, >100‚Ç¨ ERROR

================================================================================
                            EJEMPLOS DE ERRORES
================================================================================

‚ùå TAG SIN RELLENAR:
"El presupuesto total es de {{IMPORTE_TOTAL}} euros"

‚ùå S√ç/NO DUPLICADO:
"‚òë S√ç, se incluyen lotes
 ‚òë NO, no se incluyen lotes"

‚ùå FECHA INCORRECTA:
"Fecha l√≠mite: 2025-10-22" (debe ser "22/10/2025")

‚ùå IMPORTE INCORRECTO:
"Presupuesto: ‚Ç¨ 123,456.78" (debe ser "123.456,78 ‚Ç¨")

‚ùå LOTES INCONSISTENTES:
"Se divide en 3 lotes" pero solo aparecen "Lote 1" y "Lote 2"

‚ùå IDIOMA INCORRECTO:
"presupuesto de licitaci√≥n" (debe ser "pressupost de licitaci√≥")

‚ùå NUMERACI√ìN CON SALTO:
"1. Introducci√≥n
 2. Objeto del contrato
 5. Presupuesto" ‚Üê FALTA 3. y 4. (ERROR CR√çTICO)

‚ùå TABLA APLICA/NO APLICA VAC√çA:
"| Requisito ISO 9001 | APLICA | NO APLICA |
 | Certificaci√≥n      |        |           |" ‚Üê CAMPO VAC√çO (ERROR CR√çTICO)

‚ùå TABLA APLICA/NO APLICA AMBIGUA:
"| Requisito | APLICA | NO APLICA |
 | Req 1    |   X    |     X     |" ‚Üê AMBOS MARCADOS (ERROR CR√çTICO)

‚ùå SECCI√ìN OBLIGATORIA FALTANTE:
Pliego sin apartado "GARANT√çAS" (ERROR CR√çTICO)

‚ùå INCOHERENCIA NUM√âRICA EN PRESUPUESTO:
"2.- DADES ECON√íMIQUES:
 
PRESSUPOST DE LICITACI√ì: 243.936,00 euros (IVA incl√≤s), 201.600,00 euros (IVA no incl√≤s)
 
Lot | Descripci√≥                    | Pressupost (IVA incl√≤s)
1   | Carretera de Rub√≠ al Papiol   | 241.840,28
2   | Carretera del Papiol a Mira-Sol | 1.942,72

SUMA LOTES: 241.840,28 + 1.942,72 = 243.783,00 euros
PRESUPUESTO DECLARADO: 243.936,00 euros
DIFERENCIA: 153,00 euros ‚Üê ERROR CR√çTICO (>100‚Ç¨)"

‚úÖ COHERENCIA NUM√âRICA CORRECTA:
"PRESSUPOST DE LICITACI√ì: 243.936,00 euros (IVA incl√≤s)
 
Lot | Descripci√≥                    | Pressupost (IVA incl√≤s)
1   | Carretera de Rub√≠ al Papiol   | 241.840,28
2   | Carretera del Papiol a Mira-Sol | 2.095,72

SUMA LOTES: 241.840,28 + 2.095,72 = 243.936,00 euros
PRESUPUESTO DECLARADO: 243.936,00 euros
DIFERENCIA: 0,00 euros ‚Üê CORRECTO"

================================================================================
                                NOTAS
================================================================================

- Este sistema debe ejecutarse ANTES de la validaci√≥n estructural completa
- Los errores cr√≠ticos deben impedir continuar el proceso
- Las advertencias se incluyen en el informe pero no bloquean
- Actualizar patrones seg√∫n feedback del generador de pliegos
- Mantener estad√≠sticas de errores m√°s frecuentes

================================================================================
                                    FIN
================================================================================
