EJEMPLOS DE PLIEGOS MAL FORMADOS - ENTRENAMIENTO IA
================================================================

OBJETIVO: Entrenar la IA para reconocer patrones específicos de errores
en pliegos mediante ejemplos reales de documentos mal formados.

METODOLOGÍA DE ENTRENAMIENTO:
1. Subir pliegos con errores conocidos al contexto RAG "PLIEGOS_ERRORES_EJEMPLOS"
2. Documentar cada error específico encontrado
3. Crear patrones de detección automática
4. Validar mejoras en la detección

TIPOS DE ERRORES A DOCUMENTAR:
===============================

1. CAMPOS VARIABLES SIN RELLENAR:
   - Tags SAP no reemplazados: {{PRESUPUESTO_BASE}}
   - Campos con valores por defecto: [INSERTAR_FECHA]
   - Variables vacías: {{}} o {{ }}

1.1. TAGS SAP ESPECÍFICOS SIN REEMPLAZAR:
   
   DESCRIPCIÓN DE CONTRATOS:
   ❌ MAL: CONTRACTE D'EXECUCIÓ DE LES OBRES DE (Descripció llarga del Procediment d'Adjudicació)
   ✅ BIEN: CONTRACTE D'EXECUCIÓ DE LES OBRES DEL PROJECTE CONSTRUCTIU DE LA RENOVACIÓ PER OBSOLESCÈNCIA D'EQUIPAMENTS DEL SISTEMA DE VIDEOVIGILÀNCIA DEL TRAM IV DE L'L9 DE METRO DE BARCELONA
   
   CLÁUSULAS DE EXPEDIENTE:
   ❌ MAL: CLAU: (Clau - Expedient Descripció Abreujada)
   ✅ BIEN: CLAU: R0-21223 o CLAU: ATL-23261
   
   INFORMACIÓN DE LOTES:
   ❌ MAL: [ZERM_QUADRE_LOTS-Z_DESCRIP_LOT]
   ✅ BIEN: Vilafranca del Penedès – La Granada
   ❌ MAL: [ZERM_QUADRE_LOTS-ZZ_NUM_LOT]
   ✅ BIEN: 1, 2, 3, 4...
   
   LOGOS Y CABECERAS:
   ❌ MAL: (Capçalera: Logos segons empresa i fons de finançament - ALTRES DOCS)
   ✅ BIEN: [Logo corporativo insertado]
   
   TÉRMINOS DE EJECUCIÓN:
   ❌ MAL: (Termini execució licitació) (Hora)(Dia)(Semana)(Mes)(Año)
           Lot Termini (mesos) Condicions
           [ZERM_QDC_CLO_LIC-ZZ_NUM_LOT]
           [ZERM_QDC_CLO_LIC-Z_TERM_LOT]
           [ZERM_QDC_CLO_LIC-Z_OBRES_SIM]
           (Justificació no lots)
   ✅ BIEN: 3.- TERMINI D'EXECUCIÓ DEL CONTRACTE:
           Lot Termini (mesos)
           1   5 mesos
           2   5 mesos  
           3   10 mesos
           4   6 mesos
   
   INFORMACIÓN PRESUPUESTARIA Y GARANTÍAS:
   ❌ MAL: Partida pressupostària: (Partida pressupostària)
           GARANTIA PROVISIONAL: (Si no garantia provisional) (Si garantia provisional) (Percentatge aval provisional)
           GARANTIA DEFINITIVA: (Percentatge aval definitiu)%
           PERIODE DE GARANTIA: (Termini de garantia) mesos
   ✅ BIEN: Partida pressupostària: D/660.0002 – Programa 521
           GARANTIA PROVISIONAL: NO
           GARANTIA DEFINITIVA: 5% del preu d'adjudicació (IVA no inclòs)
           PERIODE DE GARANTIA: DOS ANYS

2. CAMPOS OBLIGATORIOS INCOMPLETOS:
   - Cláusulas vacías: "CLAU:" sin contenido después
   - Apartados sin completar: "PRESUPUESTO:" seguido de línea vacía
   - Referencias sin especificar: "VER ANEXO:" sin número/nombre

3. ERRORES DE FORMATO:
   - Fechas incorrectas: 32/13/2025, 2025-12-31
   - Importes sin formato: 123456 en lugar de 123.456,78 €
   - Códigos malformados: CT123 en lugar de CT1234567

3. ERRORES ESTRUCTURALES:
   - Secciones duplicadas
   - Apartados faltantes obligatorios
   - Numeración incorrecta (1.1, 1.3, 1.5 - falta 1.2, 1.4)

4. ERRORES DE CONTENIDO:
   - Información contradictoria
   - Referencias cruzadas incorrectas
   - Datos inconsistentes entre secciones

5. ERRORES DE LOTES:
   - Lotes mal definidos
   - Presupuestos de lotes no cuadran con total
   - Información de lotes en pliegos "sin lotes"

FORMATO DE DOCUMENTACIÓN POR CADA PLIEGO:
=========================================

ARCHIVO: [nombre_del_pliego.pdf]
TIPO_ERROR: [categoria_del_error]
DESCRIPCIÓN: [descripción_detallada]
UBICACIÓN: [sección/línea donde aparece]
PATRÓN_DETECCIÓN: [regex o patrón para detectar automáticamente]
CORRECCIÓN_SUGERIDA: [cómo debería ser]

EJEMPLOS DE DOCUMENTACIÓN:
-------------------------

EJEMPLO 1 - CAMPO VARIABLE SIN RELLENAR:
ARCHIVO: CT1234567_plec_obra_civil_obert_amb_lots_validacion.pdf
TIPO_ERROR: CAMPO_VARIABLE_SIN_RELLENAR
DESCRIPCIÓN: Tag SAP {{PRESUPUESTO_BASE}} no reemplazado en sección presupuesto
UBICACIÓN: Sección 4.2, línea aproximada 156
PATRÓN_DETECCIÓN: /\{\{[A-Z_]+\}\}/g
CORRECCIÓN_SUGERIDA: Reemplazar con valor numérico formato 123.456,78 €

EJEMPLO 2 - CLÁUSULA INCOMPLETA:
ARCHIVO: CT1234567_plec_edificacio_sense_lots_validacion_ERROR_CLAU.pdf
TIPO_ERROR: CAMPO_OBLIGATORIO_INCOMPLETO
DESCRIPCIÓN: Cláusula vacía "CLAU:" sin especificar contenido
UBICACIÓN: Múltiples secciones, aparece "CLAU:" seguido de línea vacía
PATRÓN_DETECCIÓN: /CLAU:\s*$/gm
CORRECCIÓN_SUGERIDA: Completar con cláusula específica, ej: "CLAU: Cláusula de penalización por retraso"

EJEMPLO 3 - PRESUPUESTO INCOMPLETO:
ARCHIVO: CT1234567_plec_obra_civil_validacion_ERROR_PRESUPUESTO.pdf
TIPO_ERROR: CAMPO_OBLIGATORIO_INCOMPLETO
DESCRIPCIÓN: Apartado "PRESUPUESTO:" sin detallar importes
UBICACIÓN: Sección presupuestaria
PATRÓN_DETECCIÓN: /PRESUPUESTO:\s*$/gm
CORRECCIÓN_SUGERIDA: Añadir desglose de importes y total

EJEMPLO 4 - TAG SAP DESCRIPCIÓN SIN REEMPLAZAR:
ARCHIVO: CT1234567_plec_edificacio_validacion_ERROR_DESCRIPCIO.pdf
TIPO_ERROR: TAG_SAP_SIN_REEMPLAZAR
DESCRIPCIÓN: Tag "(Descripció llarga del Procediment d'Adjudicació)" sin reemplazar
UBICACIÓN: Título del contrato, línea 1
PATRÓN_DETECCIÓN: /\([^)]*Descripció[^)]*\)/g
CORRECCIÓN_SUGERIDA: Reemplazar con descripción específica del proyecto

EJEMPLO 5 - CLÁUSULA EXPEDIENTE SIN COMPLETAR:
ARCHIVO: CT1234567_plec_obra_civil_validacion_ERROR_CLAU_EXPEDIENT.pdf
TIPO_ERROR: TAG_SAP_SIN_REEMPLAZAR
DESCRIPCIÓN: Tag "(Clau - Expedient Descripció Abreujada)" sin reemplazar
UBICACIÓN: Sección CLAU
PATRÓN_DETECCIÓN: /\(Clau - Expedient[^)]*\)/g
CORRECCIÓN_SUGERIDA: Reemplazar con código específico como "R0-21223" o "ATL-23261"

EJEMPLO 6 - TAGS ZERM SIN REEMPLAZAR:
ARCHIVO: CT1234567_plec_obra_civil_validacion_ERROR_ZERM.pdf
TIPO_ERROR: TAG_SAP_SIN_REEMPLAZAR
DESCRIPCIÓN: Tags "[ZERM_QUADRE_LOTS-Z_DESCRIP_LOT]" y "[ZERM_QUADRE_LOTS-ZZ_NUM_LOT]" sin reemplazar
UBICACIÓN: Sección de lotes
PATRÓN_DETECCIÓN: /\[ZERM_[A-Z_-]+\]/g
CORRECCIÓN_SUGERIDA: Reemplazar con descripción y número de lote específicos

EJEMPLO 7 - GARANTÍAS SIN ESPECIFICAR:
ARCHIVO: CT1234567_plec_edificacio_validacion_ERROR_GARANTIES.pdf
TIPO_ERROR: TAG_SAP_SIN_REEMPLAZAR
DESCRIPCIÓN: Tags "(Si no garantia provisional)" y "(Percentatge aval definitiu)" sin reemplazar
UBICACIÓN: Sección de garantías
PATRÓN_DETECCIÓN: /\(Si no garantia[^)]*\)/g, /\(Percentatge aval[^)]*\)/g
CORRECCIÓN_SUGERIDA: Especificar "NO" o porcentaje concreto como "5%"

INSTRUCCIONES DE USO:
====================

1. SUBIR PLIEGOS PROBLEMÁTICOS:
   - Usar contexto RAG: "DOCUMENTOS_VALIDACION" (contexto existente)
   - Incluir en nombre del archivo: "_validacion_ERROR_[tipo]"
   - Ejemplo: CT1234567_plec_obra_civil_amb_lots_validacion_ERROR_CAMPOS.pdf

2. DOCUMENTAR CADA ERROR:
   - Crear archivo .txt por cada pliego con errores
   - Seguir formato estándar de documentación
   - Incluir capturas de pantalla si es necesario

3. VALIDAR MEJORAS:
   - Probar endpoint de validación con pliegos corregidos
   - Verificar que detecta los errores documentados
   - Ajustar prompts según resultados

PATRONES DE DETECCIÓN AUTOMÁTICA:
=================================

CAMPOS_VARIABLES_SIN_RELLENAR:
- Regex: /\{\{[^}]*\}\}/g
- Búsqueda: [INSERTAR_, [COMPLETAR_, [RELLENAR_
- Patrones: {{ }}, {{  }}, {{VARIABLE}}

CAMPOS_OBLIGATORIOS_INCOMPLETOS:
- Regex: /CLAU:\s*$/gm (CLAU: seguido solo de espacios y fin de línea)
- Regex: /PRESUPUESTO:\s*$/gm (PRESUPUESTO: sin contenido)
- Regex: /VER ANEXO:\s*$/gm (VER ANEXO: sin especificar)
- Regex: /ARTICLE:\s*$/gm (ARTICLE: sin número)
- Patrón general: /[A-Z]+:\s*$/gm (cualquier etiqueta seguida de dos puntos y vacía)

TAGS_SAP_SIN_REEMPLAZAR:
- Regex: /\([^)]*Descripció[^)]*\)/g (descripciones entre paréntesis sin reemplazar)
- Regex: /\(Clau - Expedient[^)]*\)/g (cláusulas de expediente sin completar)
- Regex: /\[ZERM_[A-Z_-]+\]/g (tags ZERM sin reemplazar)
- Regex: /\(Capçalera:[^)]*\)/g (cabeceras con logos sin insertar)
- Regex: /\(Termini execució[^)]*\)/g (términos de ejecución sin especificar)
- Regex: /\(Partida pressupostària\)/g (partidas presupuestarias sin completar)
- Regex: /\(Si no garantia[^)]*\)/g (condiciones de garantía sin decidir)
- Regex: /\(Percentatge aval[^)]*\)/g (porcentajes de aval sin especificar)
- Regex: /\(Termini de garantia\)/g (términos de garantía sin completar)
- Regex: /\([A-Z][^)]*\)/g (cualquier texto descriptivo entre paréntesis)
- Regex: /\[[A-Z_-]+\]/g (cualquier tag entre corchetes sin reemplazar)

FECHAS_INCORRECTAS:
- Regex: /\d{2}\/\d{2}\/\d{4}/g (validar rangos)
- Detectar: días > 31, meses > 12, años < 2020 o > 2030
- Formatos incorrectos: DD-MM-YYYY, YYYY/MM/DD

IMPORTES_SIN_FORMATO:
- Regex: /\d{4,}(?!\.\d{2})/g (números largos sin formato)
- Detectar ausencia de: puntos de miles, símbolo €
- Patrones incorrectos: 123456, 123,456.78

CÓDIGOS_EXPEDIENTE_MALFORMADOS:
- Regex: /CT\d{1,6}(?!\d)/g (menos de 7 dígitos)
- Detectar: CT123, CT12345 (incompletos)
- Formato correcto: CT1234567

SECCIONES_DUPLICADAS:
- Detectar títulos repetidos
- Numeración duplicada (1.1, 1.1)
- Contenido idéntico en múltiples secciones

REFERENCIAS_CRUZADAS_INCORRECTAS:
- Referencias a secciones inexistentes
- Números de página incorrectos
- Enlaces rotos a anexos

INTEGRACIÓN CON SISTEMA DE VALIDACIÓN:
======================================

El sistema cargará automáticamente estos ejemplos para:
1. Mejorar detección de patrones
2. Generar alertas más específicas
3. Sugerir correcciones precisas
4. Crear informes más detallados

ACTUALIZACIÓN CONTINUA:
======================

- Añadir nuevos ejemplos según se encuentren errores
- Refinar patrones de detección
- Actualizar prompts de validación
- Documentar casos edge y excepciones
